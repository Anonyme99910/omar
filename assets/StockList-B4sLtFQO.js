import{_ as E,b as T,r as i,h as z,c as u,o as d,d as t,j as C,k as q,x as L,l as w,e as n,v as r,A as N,F as j,m as B,s as P,t as a,w as V,y as b}from"./index-Brk4Sr_p.js";import{P as I}from"./plus-BuwakW5B.js";import{P as $}from"./pen-square-BcZ0agMP.js";import{T as A}from"./trash-2-D4FOKSnq.js";import"./createLucideIcon-B_xpme5I.js";const D={class:"stock-container"},K={class:"header"},O={class:"header-actions"},Q={class:"filters"},G={class:"checkbox-label"},H={class:"table-container"},J={class:"font-mono text-sm"},R={class:"font-medium"},W={class:"text-center"},X={class:"text-green-600 font-semibold"},Y={class:"text-blue-600 font-semibold"},Z={class:"text-yellow-600 font-semibold"},tt={class:"text-gray-500"},et={key:0,class:"status-badge low"},lt={key:1,class:"status-badge ok"},st={class:"actions"},ot=["onClick"],at=["onClick"],nt={key:0,class:"empty-state"},rt={class:"modal-header"},it={class:"modal-body"},ut={class:"form-row"},dt={class:"form-group"},ct={class:"form-group"},mt={class:"form-row"},pt={class:"form-group"},vt={class:"form-group"},_t={class:"form-group"},bt={class:"form-row"},yt={class:"form-group"},ft={class:"form-group"},kt={class:"modal-footer"},gt={type:"submit",class:"btn-primary"},ht={__name:"StockList",setup(xt){const c=T(),y=i([]),f=i(""),k=i(!1),v=i(!1),m=i(!1),g=i(null),o=i({name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10}),p=async()=>{try{const s={search:f.value,low_stock:k.value?1:0},e=await b.getProducts(s);y.value=e.data.data||e.data}catch(s){console.error("Error fetching products:",s),c.error("فشل تحميل المنتجات")}},U=()=>{m.value=!1,o.value={name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10},v.value=!0},M=s=>{m.value=!0,g.value=s.id,o.value={name_ar:s.name_ar,price_جملة:parseFloat(s.price_جملة),price_قطاعي:parseFloat(s.price_قطاعي),price_صفحة:parseFloat(s.price_صفحة),volume_ml:s.volume_ml||"",quantity:s.quantity,alert_quantity:s.alert_quantity},v.value=!0},S=async()=>{var s,e;try{m.value?(await b.updateProduct(g.value,o.value),c.success("تم تحديث المنتج بنجاح")):(await b.createProduct(o.value),c.success("تم إضافة المنتج بنجاح")),_(),p()}catch(l){console.error("Error saving product:",l);const x=(e=(s=l.response)==null?void 0:s.data)!=null&&e.errors?Object.values(l.response.data.errors).flat().join(", "):"حدث خطأ أثناء حفظ المنتج";c.error(x)}},F=async s=>{if(confirm("هل أنت متأكد من حذف هذا المنتج؟"))try{await b.deleteProduct(s),c.success("تم حذف المنتج بنجاح"),p()}catch(e){console.error("Error deleting product:",e),c.error("فشل حذف المنتج")}},_=()=>{v.value=!1,m.value=!1,g.value=null},h=s=>`${parseFloat(s).toFixed(2)} جنيه`;return z(()=>{p()}),(s,e)=>(d(),u("div",D,[t("div",K,[e[11]||(e[11]=t("h1",null,"إدارة المخزون",-1)),t("div",O,[t("button",{onClick:U,class:"btn-success"},[q(w(I),{size:18}),e[10]||(e[10]=L(" إضافة منتج ",-1))])])]),t("div",Q,[n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),type:"text",placeholder:"بحث بالاسم أو SKU...",class:"search-input",onInput:p},null,544),[[r,f.value]]),t("label",G,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=l=>k.value=l),onChange:p},null,544),[[N,k.value]]),e[12]||(e[12]=t("span",null,"عرض المنتجات منخفضة المخزون فقط",-1))])]),t("div",H,[t("table",null,[e[13]||(e[13]=t("thead",null,[t("tr",null,[t("th",null,"SKU"),t("th",null,"المنتج"),t("th",null,"الحجم"),t("th",null,"سعر جملة"),t("th",null,"سعر قطاعي"),t("th",null,"سعر صفحة"),t("th",null,"الكمية"),t("th",null,"حد التنبيه"),t("th",null,"الحالة"),t("th",null,"الإجراءات")])],-1)),t("tbody",null,[(d(!0),u(j,null,B(y.value,l=>(d(),u("tr",{key:l.id,class:P({"bg-red-50":l.is_low_stock})},[t("td",J,a(l.sku),1),t("td",R,a(l.name_ar),1),t("td",W,a(l.volume_ml)+" مل",1),t("td",X,a(h(l.price_جملة)),1),t("td",Y,a(h(l.price_قطاعي)),1),t("td",Z,a(h(l.price_صفحة)),1),t("td",null,[t("span",{class:P(l.is_low_stock?"text-red-600 font-bold":"")},a(l.quantity),3)]),t("td",tt,a(l.alert_quantity),1),t("td",null,[l.is_low_stock?(d(),u("span",et,"منخفض")):(d(),u("span",lt,"متوفر"))]),t("td",st,[t("button",{onClick:x=>M(l),class:"btn-icon",title:"تعديل"},[q(w($),{size:18})],8,ot),t("button",{onClick:x=>F(l.id),class:"btn-icon text-red-600",title:"حذف"},[q(w(A),{size:18})],8,at)])],2))),128))])]),y.value.length===0?(d(),u("div",nt," لا توجد منتجات ")):C("",!0)]),v.value?(d(),u("div",{key:0,class:"modal-overlay",onClick:_},[t("div",{class:"modal modal-large",onClick:e[9]||(e[9]=V(()=>{},["stop"]))},[t("div",rt,[t("h3",null,a(m.value?"تعديل منتج":"إضافة منتج جديد"),1),t("button",{onClick:_,class:"btn-close"},"×")]),t("div",it,[t("form",{onSubmit:V(S,["prevent"])},[t("div",ut,[t("div",dt,[e[14]||(e[14]=t("label",null,"اسم المنتج (عربي) *",-1)),n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.name_ar=l),type:"text",required:"",placeholder:"عطر الورد"},null,512),[[r,o.value.name_ar]])]),t("div",ct,[e[15]||(e[15]=t("label",null,"الحجم (مل)",-1)),n(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.volume_ml=l),type:"text",placeholder:"100 مل"},null,512),[[r,o.value.volume_ml]]),e[16]||(e[16]=t("small",{class:"text-gray-500"},"مثال: 50 مل، 100 مل، إلخ",-1))])]),t("div",mt,[t("div",pt,[e[17]||(e[17]=t("label",null,"سعر الجملة *",-1)),n(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.price_جملة=l),type:"number",step:"0.01",required:"",placeholder:"85.00",class:"price-input-wholesale"},null,512),[[r,o.value.price_جملة,void 0,{number:!0}]]),e[18]||(e[18]=t("small",{class:"text-gray-500"},"سعر البيع للعملاء الجملة",-1))]),t("div",vt,[e[19]||(e[19]=t("label",null,"سعر القطاعي *",-1)),n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.price_قطاعي=l),type:"number",step:"0.01",required:"",placeholder:"100.00",class:"price-input-retail"},null,512),[[r,o.value.price_قطاعي,void 0,{number:!0}]]),e[20]||(e[20]=t("small",{class:"text-gray-500"},"سعر البيع للعملاء القطاعي",-1))])]),t("div",_t,[e[21]||(e[21]=t("label",null,"سعر صفحة *",-1)),n(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.price_صفحة=l),type:"number",step:"0.01",required:"",placeholder:"110.00",class:"price-input-online"},null,512),[[r,o.value.price_صفحة,void 0,{number:!0}]]),e[22]||(e[22]=t("small",{class:"text-gray-500"},"سعر البيع للعملاء صفحة",-1))]),t("div",bt,[t("div",yt,[e[23]||(e[23]=t("label",null,"الكمية *",-1)),n(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.quantity=l),type:"number",required:"",min:"0",placeholder:"100"},null,512),[[r,o.value.quantity,void 0,{number:!0}]])]),t("div",ft,[e[24]||(e[24]=t("label",null,"حد التنبيه *",-1)),n(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.alert_quantity=l),type:"number",required:"",min:"1",placeholder:"10"},null,512),[[r,o.value.alert_quantity,void 0,{number:!0}]]),e[25]||(e[25]=t("small",{class:"text-gray-500"},"سيتم التنبيه عندما تصل الكمية لهذا الحد",-1))])]),t("div",kt,[t("button",{type:"button",onClick:_,class:"btn-secondary"},"إلغاء"),t("button",gt,a(m.value?"تحديث":"إضافة"),1)])],32)])])])):C("",!0)]))}},Ut=E(ht,[["__scopeId","data-v-98261f25"]]);export{Ut as default};
