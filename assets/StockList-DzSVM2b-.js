import{_ as I,b as L,r as n,h as N,c,o as v,d as e,j as C,k as F,x as j,l as U,e as r,v as i,A as z,F as A,m as $,t as u,w as V,y as h}from"./index-BKD5Oar3.js";import{P as G}from"./plus-BCw8-tgt.js";import{P as R}from"./pen-square-DyMWKTRB.js";import{T as J}from"./trash-2-xN52SsB0.js";import"./createLucideIcon-C2Kbf_sm.js";const K={class:"stock-container"},O={class:"header"},Q={class:"header-actions"},W={class:"filters"},H={class:"checkbox-label"},X={class:"table-container"},Y={class:"font-medium"},Z={class:"text-center"},ee={class:"text-green-600 font-semibold"},te={class:"text-blue-600 font-semibold"},le={class:"text-yellow-600 font-semibold"},se={class:"text-center"},oe={class:"actions"},ae=["onClick"],ne=["onClick"],re={key:0,class:"empty-state"},ie={class:"modal-header"},ue={class:"modal-body"},de={class:"form-row"},pe={class:"form-group"},me={class:"form-group"},ce={class:"form-group"},ve={key:0,class:"photo-preview"},_e=["src"],ye={class:"form-row"},be={class:"form-group"},fe={class:"form-group"},ge={class:"form-group"},he={class:"form-row"},xe={class:"form-group"},ke={class:"form-group"},qe={class:"modal-footer"},we={type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors"},Pe={__name:"StockList",setup(Ce){const d=L(),x=n([]),k=n(""),q=n(!1),y=n(!1),p=n(!1),w=n(null),b=n(null),f=n(null),s=n({name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10}),_=async()=>{try{const o={search:k.value,low_stock:q.value?1:0},t=await h.getProducts(o);x.value=t.data.data||t.data}catch(o){console.error("Error fetching products:",o),d.error("فشل تحميل المنتجات")}},M=o=>{const t=o.target.files[0];if(t){b.value=t;const l=new FileReader;l.onload=m=>{f.value=m.target.result},l.readAsDataURL(t)}},S=()=>{p.value=!1,b.value=null,f.value=null,s.value={name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10},y.value=!0},E=o=>{p.value=!0,w.value=o.id,s.value={name_ar:o.name_ar,price_جملة:parseFloat(o.price_جملة),price_قطاعي:parseFloat(o.price_قطاعي),price_صفحة:parseFloat(o.price_صفحة),volume_ml:o.volume_ml||"",quantity:o.quantity,alert_quantity:o.alert_quantity},y.value=!0},T=async()=>{var o,t,l,m;try{const a=new FormData;s.value.name_ar&&a.append("name_ar",s.value.name_ar),s.value.volume_ml&&a.append("volume_ml",s.value.volume_ml),a.append("price_جملة",parseFloat(s.value.price_جملة)||0),a.append("price_قطاعي",parseFloat(s.value.price_قطاعي)||0),a.append("price_صفحة",parseFloat(s.value.price_صفحة)||0),a.append("quantity",parseInt(s.value.quantity)||0),a.append("alert_quantity",parseInt(s.value.alert_quantity)||10),b.value&&a.append("photo",b.value),p.value?(a.append("_method","PUT"),await h.updateProduct(w.value,a),d.success("تم تحديث المنتج بنجاح")):(await h.createProduct(a),d.success("تم إضافة المنتج بنجاح")),g(),_()}catch(a){console.error("Error saving product:",a);const D=(t=(o=a.response)==null?void 0:o.data)!=null&&t.errors?Object.values(a.response.data.errors).flat().join(", "):((m=(l=a.response)==null?void 0:l.data)==null?void 0:m.message)||"حدث خطأ أثناء حفظ المنتج";d.error(D)}},B=async o=>{if(confirm("هل أنت متأكد من حذف هذا المنتج؟"))try{await h.deleteProduct(o),d.success("تم حذف المنتج بنجاح"),_()}catch(t){console.error("Error deleting product:",t),d.error("فشل حذف المنتج")}},g=()=>{y.value=!1,p.value=!1,w.value=null},P=o=>`${parseFloat(o).toFixed(2)} جنيه`;return N(()=>{_()}),(o,t)=>(v(),c("div",K,[e("div",O,[t[11]||(t[11]=e("h1",null,"إدارة المخزون",-1)),e("div",Q,[e("button",{onClick:S,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors"},[F(U(G),{size:20}),t[10]||(t[10]=j(" إضافة منتج ",-1))])])]),e("div",W,[r(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>k.value=l),type:"text",placeholder:"بحث بالاسم أو SKU...",class:"search-input",onInput:_},null,544),[[i,k.value]]),e("label",H,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=l=>q.value=l),onChange:_},null,544),[[z,q.value]]),t[12]||(t[12]=e("span",null,"عرض المنتجات منخفضة المخزون فقط",-1))])]),e("div",X,[e("table",null,[t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th",null,"المنتج"),e("th",null,"الحجم"),e("th",null,"سعر جملة"),e("th",null,"سعر قطاعي"),e("th",null,"سعر صفحة"),e("th",null,"الكمية"),e("th",null,"الإجراءات")])],-1)),e("tbody",null,[(v(!0),c(A,null,$(x.value,l=>(v(),c("tr",{key:l.id},[e("td",Y,u(l.name_ar),1),e("td",Z,u(l.volume_ml),1),e("td",ee,u(P(l.price_جملة)),1),e("td",te,u(P(l.price_قطاعي)),1),e("td",le,u(P(l.price_صفحة)),1),e("td",se,u(l.quantity),1),e("td",oe,[e("button",{onClick:m=>E(l),class:"btn-icon",title:"تعديل"},[F(U(R),{size:18})],8,ae),e("button",{onClick:m=>B(l.id),class:"btn-icon text-red-600",title:"حذف"},[F(U(J),{size:18})],8,ne)])]))),128))])]),x.value.length===0?(v(),c("div",re," لا توجد منتجات ")):C("",!0)]),y.value?(v(),c("div",{key:0,class:"modal-overlay",onClick:g},[e("div",{class:"modal modal-large",onClick:t[9]||(t[9]=V(()=>{},["stop"]))},[e("div",ie,[e("h3",null,u(p.value?"تعديل منتج":"إضافة منتج جديد"),1),e("button",{onClick:g,class:"btn-close"},"×")]),e("div",ue,[e("form",{onSubmit:V(T,["prevent"])},[e("div",de,[e("div",pe,[t[14]||(t[14]=e("label",null,"اسم المنتج (عربي) *",-1)),r(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.name_ar=l),type:"text",required:"",placeholder:"عطر الورد"},null,512),[[i,s.value.name_ar]])]),e("div",me,[t[15]||(t[15]=e("label",null,"الحجم (مل)",-1)),r(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.volume_ml=l),type:"text",placeholder:"100 مل"},null,512),[[i,s.value.volume_ml]]),t[16]||(t[16]=e("small",{class:"text-gray-500"},"مثال: 50 مل، 100 مل، إلخ",-1))])]),e("div",ce,[t[17]||(t[17]=e("label",null,"صورة المنتج",-1)),e("input",{type:"file",onChange:M,accept:"image/*",class:"file-input"},null,32),t[18]||(t[18]=e("small",{class:"text-gray-500"},"اختياري - الحد الأقصى: 5MB - صيغ مدعومة: JPG, PNG, WEBP",-1)),f.value?(v(),c("div",ve,[e("img",{src:f.value,alt:"Preview"},null,8,_e)])):C("",!0)]),e("div",ye,[e("div",be,[t[19]||(t[19]=e("label",null,"سعر الجملة *",-1)),r(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.price_جملة=l),type:"number",step:"0.01",required:"",placeholder:"85.00",class:"price-input-wholesale"},null,512),[[i,s.value.price_جملة,void 0,{number:!0}]]),t[20]||(t[20]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء الجملة",-1))]),e("div",fe,[t[21]||(t[21]=e("label",null,"سعر القطاعي *",-1)),r(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.price_قطاعي=l),type:"number",step:"0.01",required:"",placeholder:"100.00",class:"price-input-retail"},null,512),[[i,s.value.price_قطاعي,void 0,{number:!0}]]),t[22]||(t[22]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء القطاعي",-1))])]),e("div",ge,[t[23]||(t[23]=e("label",null,"سعر صفحة *",-1)),r(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.price_صفحة=l),type:"number",step:"0.01",required:"",placeholder:"110.00",class:"price-input-online"},null,512),[[i,s.value.price_صفحة,void 0,{number:!0}]]),t[24]||(t[24]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء صفحة",-1))]),e("div",he,[e("div",xe,[t[25]||(t[25]=e("label",null,"الكمية *",-1)),r(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.quantity=l),type:"number",required:"",min:"0",placeholder:"100"},null,512),[[i,s.value.quantity,void 0,{number:!0}]])]),e("div",ke,[t[26]||(t[26]=e("label",null,"حد التنبيه *",-1)),r(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>s.value.alert_quantity=l),type:"number",required:"",min:"1",placeholder:"10"},null,512),[[i,s.value.alert_quantity,void 0,{number:!0}]]),t[27]||(t[27]=e("small",{class:"text-gray-500"},"سيتم التنبيه عندما تصل الكمية لهذا الحد",-1))])]),e("div",qe,[e("button",{type:"button",onClick:g,class:"btn-secondary"},"إلغاء"),e("button",we,u(p.value?"تحديث":"إضافة"),1)])],32)])])])):C("",!0)]))}},Ee=I(Pe,[["__scopeId","data-v-2f482279"]]);export{Ee as default};
