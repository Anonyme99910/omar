import{_ as L,b as T,r as n,h as j,c,o as v,d as e,j as P,k as C,x as B,l as V,e as r,v as i,A as N,F as z,m as A,t as u,w as U,y as g}from"./index-D0EkREoC.js";import{P as I}from"./plus-DFMcahTe.js";import{P as $}from"./pen-square-DFQIrQb9.js";import{T as O}from"./trash-2-B-tmrdvc.js";import"./createLucideIcon-5hNyl0tl.js";const R={class:"stock-container"},K={class:"header"},Q={class:"header-actions"},G={class:"filters"},H={class:"checkbox-label"},J={class:"table-container"},W={class:"font-medium"},X={class:"text-center"},Y={class:"text-green-600 font-semibold"},Z={class:"text-blue-600 font-semibold"},ee={class:"text-yellow-600 font-semibold"},te={class:"text-center"},le={class:"actions"},se=["onClick"],oe=["onClick"],ae={key:0,class:"empty-state"},ne={class:"modal-header"},re={class:"modal-body"},ie={class:"form-row"},ue={class:"form-group"},de={class:"form-group"},pe={class:"form-group"},ce={key:0,class:"photo-preview"},ve=["src"],me={class:"form-row"},_e={class:"form-group"},be={class:"form-group"},fe={class:"form-group"},ye={class:"form-row"},ge={class:"form-group"},xe={class:"form-group"},he={class:"modal-footer"},we={type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors"},ke={__name:"StockList",setup(qe){const d=T(),x=n([]),h=n(""),w=n(!1),_=n(!1),p=n(!1),k=n(null),b=n(null),f=n(null),o=n({name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10}),m=async()=>{try{const s={search:h.value,low_stock:w.value?1:0},t=await g.getProducts(s);x.value=t.data.data||t.data}catch(s){console.error("Error fetching products:",s),d.error("فشل تحميل المنتجات")}},F=s=>{const t=s.target.files[0];if(t){b.value=t;const l=new FileReader;l.onload=a=>{f.value=a.target.result},l.readAsDataURL(t)}},M=()=>{p.value=!1,b.value=null,f.value=null,o.value={name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10},_.value=!0},S=s=>{p.value=!0,k.value=s.id,o.value={name_ar:s.name_ar,price_جملة:parseFloat(s.price_جملة),price_قطاعي:parseFloat(s.price_قطاعي),price_صفحة:parseFloat(s.price_صفحة),volume_ml:s.volume_ml||"",quantity:s.quantity,alert_quantity:s.alert_quantity},_.value=!0},E=async()=>{var s,t;try{const l=new FormData;Object.keys(o.value).forEach(a=>{o.value[a]!==null&&o.value[a]!==""&&l.append(a,o.value[a])}),b.value&&l.append("photo",b.value),p.value?(await g.updateProduct(k.value,l),d.success("تم تحديث المنتج بنجاح")):(await g.createProduct(l),d.success("تم إضافة المنتج بنجاح")),y(),m()}catch(l){console.error("Error saving product:",l);const a=(t=(s=l.response)==null?void 0:s.data)!=null&&t.errors?Object.values(l.response.data.errors).flat().join(", "):"حدث خطأ أثناء حفظ المنتج";d.error(a)}},D=async s=>{if(confirm("هل أنت متأكد من حذف هذا المنتج؟"))try{await g.deleteProduct(s),d.success("تم حذف المنتج بنجاح"),m()}catch(t){console.error("Error deleting product:",t),d.error("فشل حذف المنتج")}},y=()=>{_.value=!1,p.value=!1,k.value=null},q=s=>`${parseFloat(s).toFixed(2)} جنيه`;return j(()=>{m()}),(s,t)=>(v(),c("div",R,[e("div",K,[t[11]||(t[11]=e("h1",null,"إدارة المخزون",-1)),e("div",Q,[e("button",{onClick:M,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors"},[C(V(I),{size:20}),t[10]||(t[10]=B(" إضافة منتج ",-1))])])]),e("div",G,[r(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>h.value=l),type:"text",placeholder:"بحث بالاسم أو SKU...",class:"search-input",onInput:m},null,544),[[i,h.value]]),e("label",H,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=l=>w.value=l),onChange:m},null,544),[[N,w.value]]),t[12]||(t[12]=e("span",null,"عرض المنتجات منخفضة المخزون فقط",-1))])]),e("div",J,[e("table",null,[t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th",null,"المنتج"),e("th",null,"الحجم"),e("th",null,"سعر جملة"),e("th",null,"سعر قطاعي"),e("th",null,"سعر صفحة"),e("th",null,"الكمية"),e("th",null,"الإجراءات")])],-1)),e("tbody",null,[(v(!0),c(z,null,A(x.value,l=>(v(),c("tr",{key:l.id},[e("td",W,u(l.name_ar),1),e("td",X,u(l.volume_ml),1),e("td",Y,u(q(l.price_جملة)),1),e("td",Z,u(q(l.price_قطاعي)),1),e("td",ee,u(q(l.price_صفحة)),1),e("td",te,u(l.quantity),1),e("td",le,[e("button",{onClick:a=>S(l),class:"btn-icon",title:"تعديل"},[C(V($),{size:18})],8,se),e("button",{onClick:a=>D(l.id),class:"btn-icon text-red-600",title:"حذف"},[C(V(O),{size:18})],8,oe)])]))),128))])]),x.value.length===0?(v(),c("div",ae," لا توجد منتجات ")):P("",!0)]),_.value?(v(),c("div",{key:0,class:"modal-overlay",onClick:y},[e("div",{class:"modal modal-large",onClick:t[9]||(t[9]=U(()=>{},["stop"]))},[e("div",ne,[e("h3",null,u(p.value?"تعديل منتج":"إضافة منتج جديد"),1),e("button",{onClick:y,class:"btn-close"},"×")]),e("div",re,[e("form",{onSubmit:U(E,["prevent"])},[e("div",ie,[e("div",ue,[t[14]||(t[14]=e("label",null,"اسم المنتج (عربي) *",-1)),r(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.name_ar=l),type:"text",required:"",placeholder:"عطر الورد"},null,512),[[i,o.value.name_ar]])]),e("div",de,[t[15]||(t[15]=e("label",null,"الحجم (مل)",-1)),r(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.volume_ml=l),type:"text",placeholder:"100 مل"},null,512),[[i,o.value.volume_ml]]),t[16]||(t[16]=e("small",{class:"text-gray-500"},"مثال: 50 مل، 100 مل، إلخ",-1))])]),e("div",pe,[t[17]||(t[17]=e("label",null,"صورة المنتج",-1)),e("input",{type:"file",onChange:F,accept:"image/*",class:"file-input"},null,32),t[18]||(t[18]=e("small",{class:"text-gray-500"},"اختياري - الحد الأدنى: 200x200px، الحد الأقصى: 2000x2000px، حجم: 2MB",-1)),f.value?(v(),c("div",ce,[e("img",{src:f.value,alt:"Preview"},null,8,ve)])):P("",!0)]),e("div",me,[e("div",_e,[t[19]||(t[19]=e("label",null,"سعر الجملة *",-1)),r(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.price_جملة=l),type:"number",step:"0.01",required:"",placeholder:"85.00",class:"price-input-wholesale"},null,512),[[i,o.value.price_جملة,void 0,{number:!0}]]),t[20]||(t[20]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء الجملة",-1))]),e("div",be,[t[21]||(t[21]=e("label",null,"سعر القطاعي *",-1)),r(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.price_قطاعي=l),type:"number",step:"0.01",required:"",placeholder:"100.00",class:"price-input-retail"},null,512),[[i,o.value.price_قطاعي,void 0,{number:!0}]]),t[22]||(t[22]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء القطاعي",-1))])]),e("div",fe,[t[23]||(t[23]=e("label",null,"سعر صفحة *",-1)),r(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.price_صفحة=l),type:"number",step:"0.01",required:"",placeholder:"110.00",class:"price-input-online"},null,512),[[i,o.value.price_صفحة,void 0,{number:!0}]]),t[24]||(t[24]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء صفحة",-1))]),e("div",ye,[e("div",ge,[t[25]||(t[25]=e("label",null,"الكمية *",-1)),r(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>o.value.quantity=l),type:"number",required:"",min:"0",placeholder:"100"},null,512),[[i,o.value.quantity,void 0,{number:!0}]])]),e("div",xe,[t[26]||(t[26]=e("label",null,"حد التنبيه *",-1)),r(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>o.value.alert_quantity=l),type:"number",required:"",min:"1",placeholder:"10"},null,512),[[i,o.value.alert_quantity,void 0,{number:!0}]]),t[27]||(t[27]=e("small",{class:"text-gray-500"},"سيتم التنبيه عندما تصل الكمية لهذا الحد",-1))])]),e("div",he,[e("button",{type:"button",onClick:y,class:"btn-secondary"},"إلغاء"),e("button",we,u(p.value?"تحديث":"إضافة"),1)])],32)])])])):P("",!0)]))}},Me=L(ke,[["__scopeId","data-v-65167fe7"]]);export{Me as default};
