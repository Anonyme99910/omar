import{_ as Q,b as W,r as m,h as H,c as p,o as c,d as e,j as M,k as U,y as X,l as V,t as r,s as L,e as u,v as d,B as Y,F as B,m as T,w as S,z as b}from"./index-C3wN1Num.js";import{P as Z}from"./plus-CcCHKY5j.js";import{P as D}from"./pen-square-ANExiTNn.js";import{T as I}from"./trash-2-DvK6p1vU.js";import"./createLucideIcon-CfeRLYuV.js";const ee={class:"stock-container"},te={class:"header"},le={class:"header-actions"},se={class:"flex justify-center mb-6"},oe={class:"inline-flex rounded-lg border-2 border-primary-600 p-1 bg-gray-100"},ae={class:"filters"},re=["placeholder"],ne={class:"checkbox-label"},ie={class:"table-container"},ue={key:0},de={class:"font-medium"},pe={class:"text-center"},ce={class:"text-green-600 font-semibold"},ve={class:"text-blue-600 font-semibold"},me={class:"text-yellow-600 font-semibold"},_e={class:"text-center"},ye={class:"actions"},be=["onClick"],fe=["onClick"],ge={key:1},xe={class:"font-medium"},he={class:"text-green-600 font-semibold"},qe={class:"text-blue-600 font-semibold"},we={class:"text-yellow-600 font-semibold"},ke={class:"text-center"},Pe={class:"actions"},Ce=["onClick"],Ue=["onClick"],Ve={key:2,class:"empty-state"},Fe={class:"modal-header"},Me={class:"modal-body"},Ee={class:"form-row"},$e={class:"form-group"},Se={class:"form-group"},ze={class:"form-group"},Le={key:0,class:"photo-preview"},Be=["src"],Te={class:"form-row"},De={class:"form-group"},Ie={class:"form-group"},Ne={class:"form-group"},je={class:"form-row"},Ae={class:"form-group"},Ge={class:"form-group"},Re={class:"modal-footer"},Je={type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors"},Ke={class:"form-row"},Oe={class:"form-group"},Qe={class:"form-group"},We={class:"form-group"},He={key:0,class:"photo-preview"},Xe=["src"],Ye={class:"form-row"},Ze={class:"form-group"},et={class:"form-group"},tt={class:"form-group"},lt={class:"form-row"},st={class:"form-group"},ot={class:"form-group"},at={class:"modal-footer"},rt={type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors"},nt={__name:"StockList",setup(it){const v=W(),n=m("products"),E=m([]),$=m([]),h=m(""),F=m(!1),q=m(!1),_=m(!1),w=m(null),k=m(null),f=m(null),o=m({name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10}),a=m({name_ar:"",description:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,quantity:0,alert_quantity:10}),P=async()=>{try{const s={search:h.value,low_stock:F.value?1:0},t=await b.getProducts(s);E.value=t.data.data||t.data}catch(s){console.error("Error fetching products:",s),v.error("فشل تحميل المنتجات")}},z=s=>{const t=s.target.files[0];if(t){k.value=t;const l=new FileReader;l.onload=y=>{f.value=y.target.result},l.readAsDataURL(t)}},N=()=>{_.value=!1,k.value=null,f.value=null,n.value==="products"?o.value={name_ar:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,volume_ml:"",quantity:0,alert_quantity:10}:a.value={name_ar:"",description:"",price_جملة:0,price_قطاعي:0,price_صفحة:0,quantity:0,alert_quantity:10},q.value=!0},j=s=>{_.value=!0,w.value=s.id,o.value={name_ar:s.name_ar,price_جملة:parseFloat(s.price_جملة),price_قطاعي:parseFloat(s.price_قطاعي),price_صفحة:parseFloat(s.price_صفحة),volume_ml:s.volume_ml||"",quantity:s.quantity,alert_quantity:s.alert_quantity},q.value=!0},A=async()=>{var s,t,l,y;try{const i=new FormData;o.value.name_ar&&i.append("name_ar",o.value.name_ar),o.value.volume_ml&&i.append("volume_ml",o.value.volume_ml),i.append("price_جملة",parseFloat(o.value.price_جملة)||0),i.append("price_قطاعي",parseFloat(o.value.price_قطاعي)||0),i.append("price_صفحة",parseFloat(o.value.price_صفحة)||0),i.append("quantity",parseInt(o.value.quantity)||0),i.append("alert_quantity",parseInt(o.value.alert_quantity)||10),k.value&&i.append("photo",k.value),_.value?(i.append("_method","PUT"),await b.updateProduct(w.value,i),v.success("تم تحديث المنتج بنجاح")):(await b.createProduct(i),v.success("تم إضافة المنتج بنجاح")),g(),P()}catch(i){console.error("Error saving product:",i);const O=(t=(s=i.response)==null?void 0:s.data)!=null&&t.errors?Object.values(i.response.data.errors).flat().join(", "):((y=(l=i.response)==null?void 0:l.data)==null?void 0:y.message)||"حدث خطأ أثناء حفظ المنتج";v.error(O)}},G=async s=>{if(confirm("هل أنت متأكد من حذف هذا المنتج؟"))try{await b.deleteProduct(s),v.success("تم حذف المنتج بنجاح"),P()}catch(t){console.error("Error deleting product:",t),v.error("فشل حذف المنتج")}},R=async()=>{try{const s={...a.value,photo:k.value};_.value?(await b.updatePackage(w.value,s),v.success("تم تحديث الباقة بنجاح")):(await b.createPackage(s),v.success("تم إضافة الباقة بنجاح")),g(),C()}catch(s){console.error("Error saving package:",s),v.error(_.value?"فشل تحديث الباقة":"فشل إضافة الباقة")}},g=()=>{q.value=!1,_.value=!1,w.value=null},x=s=>`${parseFloat(s).toFixed(2)} جنيه`,C=async()=>{try{const s=await b.getPackages();let t=s.data.data||s.data;if(h.value){const l=h.value.toLowerCase();t=t.filter(y=>y.name_ar.toLowerCase().includes(l))}F.value&&(t=t.filter(l=>l.quantity<=l.alert_quantity)),$.value=t}catch(s){console.error("Error fetching packages:",s),v.error("فشل تحميل الباقات")}},J=s=>{_.value=!0,w.value=s.id,a.value={name_ar:s.name_ar,description:s.description||"",price_جملة:parseFloat(s.price_جملة),price_قطاعي:parseFloat(s.price_قطاعي),price_صفحة:parseFloat(s.price_صفحة),quantity:s.quantity,alert_quantity:s.alert_quantity},q.value=!0},K=async s=>{if(confirm("هل أنت متأكد من حذف هذه الباقة؟"))try{await b.deletePackage(s),v.success("تم حذف الباقة بنجاح"),C()}catch(t){console.error("Error deleting package:",t),v.error("فشل حذف الباقة")}};return H(()=>{P(),C()}),(s,t)=>(c(),p("div",ee,[e("div",te,[t[21]||(t[21]=e("h1",null,"إدارة المخزون",-1)),e("div",le,[e("button",{onClick:N,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors"},[U(V(Z),{size:20}),X(" "+r(n.value==="products"?"إضافة منتج":"إضافة باقة"),1)])])]),e("div",se,[e("div",oe,[e("button",{onClick:t[0]||(t[0]=l=>n.value="products"),class:L(["px-6 py-2 rounded-md font-medium transition-all",n.value==="products"?"bg-primary-600 text-white shadow-md":"text-gray-700 hover:bg-gray-200"])}," المنتجات ",2),e("button",{onClick:t[1]||(t[1]=l=>n.value="packages"),class:L(["px-6 py-2 rounded-md font-medium transition-all",n.value==="packages"?"bg-primary-600 text-white shadow-md":"text-gray-700 hover:bg-gray-200"])}," الباقات ",2)])]),e("div",ae,[u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>h.value=l),type:"text",placeholder:n.value==="products"?"بحث بالاسم أو SKU...":"بحث عن باقة...",class:"search-input",onInput:t[3]||(t[3]=l=>n.value==="products"?P():C())},null,40,re),[[d,h.value]]),e("label",ne,[u(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=l=>F.value=l),onChange:t[5]||(t[5]=l=>n.value==="products"?P():C())},null,544),[[Y,F.value]]),e("span",null,"عرض "+r(n.value==="products"?"المنتجات":"الباقات")+" منخفضة المخزون فقط",1)])]),e("div",ie,[n.value==="products"?(c(),p("table",ue,[t[22]||(t[22]=e("thead",null,[e("tr",null,[e("th",null,"المنتج"),e("th",null,"الحجم"),e("th",null,"سعر جملة"),e("th",null,"سعر قطاعي"),e("th",null,"سعر صفحة"),e("th",null,"الكمية"),e("th",null,"الإجراءات")])],-1)),e("tbody",null,[(c(!0),p(B,null,T(E.value,l=>(c(),p("tr",{key:l.id},[e("td",de,r(l.name_ar),1),e("td",pe,r(l.volume_ml),1),e("td",ce,r(x(l.price_جملة)),1),e("td",ve,r(x(l.price_قطاعي)),1),e("td",me,r(x(l.price_صفحة)),1),e("td",_e,r(l.quantity),1),e("td",ye,[e("button",{onClick:y=>j(l),class:"btn-icon",title:"تعديل"},[U(V(D),{size:18})],8,be),e("button",{onClick:y=>G(l.id),class:"btn-icon text-red-600",title:"حذف"},[U(V(I),{size:18})],8,fe)])]))),128))])])):(c(),p("table",ge,[t[23]||(t[23]=e("thead",null,[e("tr",null,[e("th",null,"الباقة"),e("th",null,"سعر جملة"),e("th",null,"سعر قطاعي"),e("th",null,"سعر صفحة"),e("th",null,"الكمية"),e("th",null,"الإجراءات")])],-1)),e("tbody",null,[(c(!0),p(B,null,T($.value,l=>(c(),p("tr",{key:l.id},[e("td",xe,r(l.name_ar),1),e("td",he,r(x(l.price_جملة)),1),e("td",qe,r(x(l.price_قطاعي)),1),e("td",we,r(x(l.price_صفحة)),1),e("td",ke,r(l.quantity),1),e("td",Pe,[e("button",{onClick:y=>J(l),class:"btn-icon",title:"تعديل"},[U(V(D),{size:18})],8,Ce),e("button",{onClick:y=>K(l.id),class:"btn-icon text-red-600",title:"حذف"},[U(V(I),{size:18})],8,Ue)])]))),128))])])),n.value==="products"&&E.value.length===0||n.value==="packages"&&$.value.length===0?(c(),p("div",Ve,r(n.value==="products"?"لا توجد منتجات":"لا توجد باقات"),1)):M("",!0)]),q.value?(c(),p("div",{key:0,class:"modal-overlay",onClick:g},[e("div",{class:"modal modal-large",onClick:t[20]||(t[20]=S(()=>{},["stop"]))},[e("div",Fe,[e("h3",null,r(n.value==="products"?_.value?"تعديل منتج":"إضافة منتج جديد":_.value?"تعديل باقة":"إضافة باقة جديدة"),1),e("button",{onClick:g,class:"btn-close"},"×")]),e("div",Me,[n.value==="products"?(c(),p("form",{key:0,onSubmit:S(A,["prevent"])},[e("div",Ee,[e("div",$e,[t[24]||(t[24]=e("label",null,"اسم المنتج (عربي) *",-1)),u(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.name_ar=l),type:"text",required:"",placeholder:"عطر الورد"},null,512),[[d,o.value.name_ar]])]),e("div",Se,[t[25]||(t[25]=e("label",null,"الحجم (مل)",-1)),u(e("input",{"onUpdate:modelValue":t[7]||(t[7]=l=>o.value.volume_ml=l),type:"text",placeholder:"100 مل"},null,512),[[d,o.value.volume_ml]]),t[26]||(t[26]=e("small",{class:"text-gray-500"},"مثال: 50 مل، 100 مل، إلخ",-1))])]),e("div",ze,[t[27]||(t[27]=e("label",null,"صورة المنتج",-1)),e("input",{type:"file",onChange:z,accept:"image/*",class:"file-input"},null,32),t[28]||(t[28]=e("small",{class:"text-gray-500"},"اختياري - الحد الأقصى: 5MB - صيغ مدعومة: JPG, PNG, WEBP",-1)),f.value?(c(),p("div",Le,[e("img",{src:f.value,alt:"Preview"},null,8,Be)])):M("",!0)]),e("div",Te,[e("div",De,[t[29]||(t[29]=e("label",null,"سعر الجملة *",-1)),u(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>o.value.price_جملة=l),type:"number",step:"0.01",required:"",placeholder:"85.00",class:"price-input-wholesale"},null,512),[[d,o.value.price_جملة,void 0,{number:!0}]]),t[30]||(t[30]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء الجملة",-1))]),e("div",Ie,[t[31]||(t[31]=e("label",null,"سعر القطاعي *",-1)),u(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>o.value.price_قطاعي=l),type:"number",step:"0.01",required:"",placeholder:"100.00",class:"price-input-retail"},null,512),[[d,o.value.price_قطاعي,void 0,{number:!0}]]),t[32]||(t[32]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء القطاعي",-1))])]),e("div",Ne,[t[33]||(t[33]=e("label",null,"سعر صفحة *",-1)),u(e("input",{"onUpdate:modelValue":t[10]||(t[10]=l=>o.value.price_صفحة=l),type:"number",step:"0.01",required:"",placeholder:"110.00",class:"price-input-online"},null,512),[[d,o.value.price_صفحة,void 0,{number:!0}]]),t[34]||(t[34]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء صفحة",-1))]),e("div",je,[e("div",Ae,[t[35]||(t[35]=e("label",null,"الكمية *",-1)),u(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>o.value.quantity=l),type:"number",required:"",min:"0",placeholder:"100"},null,512),[[d,o.value.quantity,void 0,{number:!0}]])]),e("div",Ge,[t[36]||(t[36]=e("label",null,"حد التنبيه *",-1)),u(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>o.value.alert_quantity=l),type:"number",required:"",min:"1",placeholder:"10"},null,512),[[d,o.value.alert_quantity,void 0,{number:!0}]]),t[37]||(t[37]=e("small",{class:"text-gray-500"},"سيتم التنبيه عندما تصل الكمية لهذا الحد",-1))])]),e("div",Re,[e("button",{type:"button",onClick:g,class:"btn-secondary"},"إلغاء"),e("button",Je,r(_.value?"تحديث":"إضافة"),1)])],32)):(c(),p("form",{key:1,onSubmit:S(R,["prevent"])},[e("div",Ke,[e("div",Oe,[t[38]||(t[38]=e("label",null,"اسم الباقة (عربي) *",-1)),u(e("input",{"onUpdate:modelValue":t[13]||(t[13]=l=>a.value.name_ar=l),type:"text",required:"",placeholder:"باقة العطور المميزة"},null,512),[[d,a.value.name_ar]])])]),e("div",Qe,[t[39]||(t[39]=e("label",null,"الوصف",-1)),u(e("textarea",{"onUpdate:modelValue":t[14]||(t[14]=l=>a.value.description=l),rows:"3",placeholder:"وصف الباقة..."},null,512),[[d,a.value.description]])]),e("div",We,[t[40]||(t[40]=e("label",null,"صورة الباقة",-1)),e("input",{type:"file",onChange:z,accept:"image/*",class:"file-input"},null,32),f.value?(c(),p("div",He,[e("img",{src:f.value,alt:"Preview"},null,8,Xe)])):M("",!0)]),e("div",Ye,[e("div",Ze,[t[41]||(t[41]=e("label",null,"سعر الجملة *",-1)),u(e("input",{"onUpdate:modelValue":t[15]||(t[15]=l=>a.value.price_جملة=l),type:"number",step:"0.01",required:"",placeholder:"75.00",class:"price-input-wholesale"},null,512),[[d,a.value.price_جملة,void 0,{number:!0}]]),t[42]||(t[42]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء جملة",-1))]),e("div",et,[t[43]||(t[43]=e("label",null,"سعر القطاعي *",-1)),u(e("input",{"onUpdate:modelValue":t[16]||(t[16]=l=>a.value.price_قطاعي=l),type:"number",step:"0.01",required:"",placeholder:"93.50",class:"price-input-retail"},null,512),[[d,a.value.price_قطاعي,void 0,{number:!0}]]),t[44]||(t[44]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء قطاعي",-1))])]),e("div",tt,[t[45]||(t[45]=e("label",null,"سعر الصفحة *",-1)),u(e("input",{"onUpdate:modelValue":t[17]||(t[17]=l=>a.value.price_صفحة=l),type:"number",step:"0.01",required:"",placeholder:"110.00",class:"price-input-online"},null,512),[[d,a.value.price_صفحة,void 0,{number:!0}]]),t[46]||(t[46]=e("small",{class:"text-gray-500"},"سعر البيع للعملاء صفحة",-1))]),e("div",lt,[e("div",st,[t[47]||(t[47]=e("label",null,"الكمية *",-1)),u(e("input",{"onUpdate:modelValue":t[18]||(t[18]=l=>a.value.quantity=l),type:"number",required:"",min:"0",placeholder:"50"},null,512),[[d,a.value.quantity,void 0,{number:!0}]])]),e("div",ot,[t[48]||(t[48]=e("label",null,"حد التنبيه *",-1)),u(e("input",{"onUpdate:modelValue":t[19]||(t[19]=l=>a.value.alert_quantity=l),type:"number",required:"",min:"1",placeholder:"10"},null,512),[[d,a.value.alert_quantity,void 0,{number:!0}]]),t[49]||(t[49]=e("small",{class:"text-gray-500"},"سيتم التنبيه عندما تصل الكمية لهذا الحد",-1))])]),e("div",at,[e("button",{type:"button",onClick:g,class:"btn-secondary"},"إلغاء"),e("button",rt,r(_.value?"تحديث":"إضافة"),1)])],32))])])])):M("",!0)]))}},mt=Q(nt,[["__scopeId","data-v-4ee62b20"]]);export{mt as default};
