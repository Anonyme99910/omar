import{t as Z}from"./numbers-BTmV-EI5.js";import{u as $,a as P,b as O,r as z,f as F,g as G,h as H,i as M,j,c as p,o as l,k as D,d as e,l as u,m as w,F as E,n as B,p as U,q as V,s as N,t as d,x as L}from"./index-VOtROKm6.js";import{U as R}from"./users-DyaL2R4H.js";import{c as T}from"./createLucideIcon-CE3J3cEQ.js";import{F as W}from"./file-text-D53P6c4w.js";import{T as q}from"./trending-up-Ct1vb3wK.js";import{R as K}from"./receipt-BnAFoNzH.js";import{P as X}from"./package-C5uJm4gG.js";import{X as Y}from"./x-CFwQhQKp.js";import{U as S}from"./user-BN3VetxL.js";import{L as J}from"./log-out-DciEggAw.js";function Q(){$();const C=P(),h=O(),a=30*60*1e3,g=2*60*1e3,I=1e3;let c=null,n=null,y=null,f=Date.now(),m=!1;const x=z(0),o=z(!1),t=()=>{f=Date.now(),m=!1,o.value=!1,n&&clearTimeout(n),c&&clearTimeout(c),n=setTimeout(()=>{m||(m=!0,o.value=!0,h.warning("سيتم تسجيل خروجك تلقائياً بعد دقيقتين بسبب عدم النشاط",{timeout:!1,closeButton:!1}))},a-g),c=setTimeout(()=>{i()},a)},i=async()=>{h.error("تم تسجيل خروجك تلقائياً بسبب عدم النشاط"),await C.logout(),window.location.href="/parfumes/login"},v=()=>{const _=Date.now()-f,A=a-_;A>0?(x.value=Math.ceil(A/1e3),A<=g&&!m&&(m=!0,o.value=!0,h.warning("سيتم تسجيل خروجك تلقائياً بعد دقيقتين بسبب عدم النشاط",{timeout:!1,closeButton:!1}))):x.value=0},k=["mousedown","mousemove","keypress","scroll","touchstart","click"],b=()=>{t()},s=()=>{k.forEach(_=>{document.addEventListener(_,b,!0)}),y=setInterval(v,I),t()},r=()=>{k.forEach(_=>{document.removeEventListener(_,b,!0)}),c&&clearTimeout(c),n&&clearTimeout(n),y&&clearInterval(y)};return F(()=>{C.isAuthenticated&&s()}),G(()=>{r()}),{timeUntilLogout:x,showWarning:o,resetTimer:t,startMonitoring:s,stopMonitoring:r}}/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=T("BoxesIcon",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=T("CreditCardIcon",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=T("LayoutDashboardIcon",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=T("MenuIcon",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=T("TagsIcon",[["path",{d:"M9 5H2v7l6.29 6.29c.94.94 2.48.94 3.42 0l3.58-3.58c.94-.94.94-2.48 0-3.42L9 5Z",key:"gt587u"}],["path",{d:"M6 9.01V9",key:"1flxpt"}],["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}]]),ne={class:"min-h-screen bg-gray-50"},re={class:"p-6 flex items-start justify-between gap-3"},ie={class:"px-4 space-y-1"},le={class:"font-medium"},ce={key:0,class:"mr-6 mt-1 space-y-1 border-r pr-3 border-gray-100"},ue={class:"font-medium"},de={class:"absolute bottom-0 left-0 right-0 p-4 border-t space-y-2"},me={class:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center"},pe={class:"flex-1 text-right"},he={class:"font-medium text-sm"},ye={class:"text-xs text-gray-500"},fe={class:"lg:mr-64 min-h-screen"},ge={class:"bg-white border-b border-gray-200 sticky top-0 z-20"},xe={class:"px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between"},ve={class:"flex-1 lg:flex-none pr-16 lg:pr-0"},ke={class:"text-xl sm:text-2xl font-bold text-gray-900"},be={class:"text-xs sm:text-sm text-gray-500 mt-1 hidden sm:block"},_e={class:"flex items-center gap-2 sm:gap-4"},we={class:"text-left"},Te={class:"text-sm font-medium text-gray-900"},Ie={class:"text-xs text-gray-500"},Me={class:"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center"},Le={class:"p-4 sm:p-6 lg:p-8"},Se={__name:"MainLayout",setup(C){$();const h=H(),a=P();Q();const g=M(()=>a.user),I=M(()=>a.user),c=z(""),n=z(!1),y=[{name:"لوحة التحكم",path:"/",icon:se,permission:"dashboard",children:[{name:"العملاء",path:"/clients",icon:R,permission:"clients"},{name:"الموظفون",path:"/employees",icon:R,permission:"employees"},{name:"الأدوار والصلاحيات",path:"/roles",icon:ae,permission:"roles"}]},{name:"نقطة البيع",path:"/pos",icon:te,permission:"pos"},{name:"الفواتير",path:"/invoices",icon:W,permission:"invoices"},{name:"تحليل المبيعات",path:"/sales-analysis",icon:q,permission:"sales-analysis"},{name:"المصروفات",path:"/expenses",icon:K,permission:"expenses"},{name:"المخزون",path:"/stock",icon:X,permission:"stock"},{name:"المنتجات التالفة",path:"/inventory",icon:ee,permission:"inventory"}],f=M(()=>a.isAdmin?y:!a.user||!a.user.permissions?[]:y.filter(o=>a.hasPermission(o.permission)).map(o=>{const t={...o};return t.children&&(t.children=t.children.filter(i=>a.hasPermission(i.permission))),t})),m=M(()=>{const o=f.value.find(t=>t.path===h.path);if(o)return o.name;for(const t of f.value)if(t.children){const i=t.children.find(v=>v.path===h.path);if(i)return i.name}return"لوحة التحكم"}),x=async()=>{await a.logout(),window.location.href="/parfumes/login"};return F(async()=>{a.isAuthenticated&&!a.isAdmin&&await a.fetchUser();const t=new Date().toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"});c.value=Z(t)}),(o,t)=>{var k,b;const i=j("router-link"),v=j("router-view");return l(),p("div",ne,[n.value?D("",!0):(l(),p("button",{key:0,onClick:t[0]||(t[0]=s=>n.value=!0),class:"lg:hidden fixed top-4 right-4 z-50 p-3 rounded-xl bg-primary-600 text-white shadow-lg active:scale-95","aria-label":"open menu"},[u(w(oe),{size:26})])),n.value?(l(),p("div",{key:1,onClick:t[1]||(t[1]=s=>n.value=!1),class:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30"})):D("",!0),e("aside",{class:L(["fixed right-0 top-0 h-screen w-64 bg-white border-l border-gray-200 shadow-lg z-40 transition-transform duration-300",n.value?"translate-x-0":"translate-x-full lg:translate-x-0"])},[e("div",re,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-primary-600 leading-tight"},"متجر العطور"),e("p",{class:"text-sm text-gray-500 mt-0.5"},"نظام الإدارة")],-1)),e("button",{onClick:t[2]||(t[2]=s=>n.value=!1),class:"lg:hidden p-2 rounded-lg bg-primary-600 text-white shadow","aria-label":"close menu"},[u(w(Y),{size:20})])]),e("nav",ie,[(l(!0),p(E,null,B(f.value,s=>(l(),p(E,{key:s.path},[u(i,{to:s.path,class:L(["flex items-center gap-3 px-4 py-3 rounded-lg transition-all hover:bg-primary-50 hover:text-primary-600",{"bg-primary-50 text-primary-600":o.$route.path===s.path}])},{default:U(()=>[(l(),V(N(s.icon),{size:20})),e("span",le,d(s.name),1)]),_:2},1032,["to","class"]),s.path==="/"&&s.children?(l(),p("div",ce,[(l(!0),p(E,null,B(s.children,r=>(l(),V(i,{key:r.path,to:r.path,class:L(["flex items-center gap-3 px-4 py-2 rounded-lg transition-all hover:bg-primary-50 hover:text-primary-600 text-sm",{"bg-primary-50 text-primary-600":o.$route.path===r.path}])},{default:U(()=>[(l(),V(N(r.icon),{size:18})),e("span",ue,d(r.name),1)]),_:2},1032,["to","class"]))),128))])):D("",!0)],64))),128))]),e("div",de,[u(i,{to:"/profile",class:L(["flex items-center gap-3 px-4 py-3 w-full rounded-lg transition-all hover:bg-blue-50 hover:text-blue-600 text-gray-700",{"bg-blue-50 text-blue-600":o.$route.path==="/profile"}])},{default:U(()=>{var s,r;return[e("div",me,[u(w(S),{size:16,class:"text-white"})]),e("div",pe,[e("div",he,d(((s=I.value)==null?void 0:s.name)||"Admin"),1),e("div",ye,d(((r=I.value)==null?void 0:r.role)||"admin"),1)])]}),_:1},8,["class"]),e("button",{onClick:x,class:"flex items-center gap-3 px-4 py-3 w-full rounded-lg transition-all hover:bg-red-50 hover:text-red-600 text-gray-700"},[u(w(J),{size:20}),t[4]||(t[4]=e("span",{class:"font-medium"},"تسجيل الخروج",-1))])])],2),e("main",fe,[e("header",ge,[e("div",xe,[e("div",ve,[e("h2",ke,d(m.value),1),e("p",be,d(c.value),1)]),e("div",_e,[e("div",we,[e("p",Te,d((k=g.value)==null?void 0:k.name),1),e("p",Ie,d((b=g.value)==null?void 0:b.role),1)]),e("div",Me,[u(w(S),{size:20,class:"text-primary-600"})])])])]),e("div",Le,[u(v)])])])}}};export{Se as default};
